{"version":3,"sources":["uni-app:///main.js","webpack:///D:/私活项目/打车/Take-Taxi/pages/Login/Login.vue?ba63","webpack:///D:/私活项目/打车/Take-Taxi/pages/Login/Login.vue?9573","webpack:///D:/私活项目/打车/Take-Taxi/pages/Login/Login.vue?ef63","webpack:///D:/私活项目/打车/Take-Taxi/pages/Login/Login.vue?0c2d","uni-app:///pages/Login/Login.vue?vue&type=script&lang=ts&"],"names":["createPage","Page"],"mappings":"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","file":"pages/Login/Login.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/Login/Login.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./Login.vue?vue&type=template&id=3a2da0cc&\"\nvar renderjs\nimport script from \"./Login.vue?vue&type=script&lang=ts&\"\nexport * from \"./Login.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/Login/Login.vue\"\nexport default component.exports","export * from \"-!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Login.vue?vue&type=template&id=3a2da0cc&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--13-1!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-2!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Login.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--13-1!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-2!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Login.vue?vue&type=script&lang=ts&\"","\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nimport {Component, Mixins} from 'vue-property-decorator';\r\nimport VueMixins from '../../mixins/VueMixins.ts';\r\n\r\n@Component({\r\n  name: 'Login'\r\n})\r\nexport default class Login extends Mixins(VueMixins) {\r\n  sessionKey = '';\r\n  openId = '';\r\n  userInfo = {\r\n    avatarUrl: '',\r\n    city: '',\r\n    country: '',\r\n    gender: 0,\r\n    language: '',\r\n    nickName: '',\r\n    province: '',\r\n  };\r\n  pageOption = {};\r\n\r\n  // 第一授权获取用户信息 ===》按钮触发\r\n  wxGetUserInfo() {\r\n    // 1.获取用户的信息\r\n    uni.getUserProfile({\r\n      desc: '获取你的昵称、头像、地区及性别',\r\n      success: (infoRes) => {\r\n        debugger\r\n        console.log('登录信息：', infoRes);\r\n        this.userInfo = infoRes.userInfo;\r\n\r\n        // 用户信息写入缓存\r\n        uni.showToast({title: '登录成功'});\r\n        uni.setStorageSync('user_id', new Date().toString());\r\n        uni.setStorageSync('user_nickName', this.userInfo.nickName);\r\n        uni.setStorageSync('user_avatarUrl', this.userInfo.avatarUrl);\r\n        uni.setStorageSync('user_nu', new Date().toString());\r\n\r\n        uni.switchTab({url: '../Home/Home'})\r\n\r\n        // 2.提交数据到后台、写入数据库\r\n        // uni.request({\r\n        //   url: _self.apiServer + 'appletsUserInfo',\r\n        //   data: {\r\n        //     openid: _self.openId,\r\n        //     avatarUrl: _self.userInfo.avatarUrl,\r\n        //     city: _self.userInfo.city,\r\n        //     country: _self.userInfo.country,\r\n        //     gender: _self.userInfo.gender,\r\n        //     language: _self.userInfo.language,\r\n        //     nickName: _self.userInfo.nickName\r\n        //   },\r\n        //   method: 'POST',\r\n        //   success: res => {\r\n        //     if (res.data.code != 0) {\r\n        //       uni.showToast({\r\n        //         title: res.data.msg,\r\n        //         icon: 'none'\r\n        //       });\r\n        //       return false;\r\n        //     }\r\n        //     // 用户信息写入缓存\r\n        //     uni.showToast({ title: '登录成功' });\r\n        //     uni.setStorageSync('user_id', res.data.res.u_id);\r\n        //     uni.setStorageSync('user_nm', res.data.res.u_nickName);\r\n        //     uni.setStorageSync('user_fa', res.data.res.u_avatarUrl);\r\n        //     uni.setStorageSync('user_nu', res.data.res.u_regtime);\r\n        //     // 然后跳回原页面\r\n        //     if (_self.pageOption.backtype == 1) {\r\n        //       uni.redirectTo({ url: _self.pageOption.backpage });\r\n        //     } else {\r\n        //       uni.switchTab({ url: _self.pageOption.backpage });\r\n        //     }\r\n        //   },\r\n        //   fail: () => {\r\n        //     uni.showToast({\r\n        //       title: '用户信息操作失败',\r\n        //       icon: 'none'\r\n        //     });\r\n        //   }\r\n        // });\r\n      },\r\n      fail: (e) => {\r\n        debugger\r\n        uni.showToast({\r\n          title: '获取用户信息失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    });\r\n    return false;\r\n  }\r\n\r\n  // 登录\r\n  login() {\r\n    debugger\r\n    // 0. 显示加载的效果\r\n    uni.showLoading({\r\n      title: '登录中...'\r\n    });\r\n\r\n    // 1. wx 获取登录用户 code\r\n    uni.login({\r\n      provider: 'weixin',\r\n      success: loginRes => {\r\n        debugger\r\n        console.log(loginRes);\r\n        this.js_code = loginRes.code;\r\n        // 2. 将用户登录code传递到后台置换用户SessionKey、OpenId等信息\r\n        uni.request({\r\n          url: 'https://api.weixin.qq.com/sns/jscode2session',\r\n          method: 'GET',\r\n          data: {\r\n            appid: this.appid, //你的小程序的APPID\r\n            secret: this.secret, //你的小程序的secret,\r\n            js_code: this.js_code, //wx.login 登录成功后的code\r\n            grant_type: 'authorization_code'\r\n          },\r\n          success: codeRes => {\r\n            debugger\r\n            console.log(codeRes);\r\n            this.openId = codeRes.data.openid;\r\n            this.sessionKey = codeRes.data.session_key;\r\n\r\n            // 用户信息写入缓存\r\n            uni.showToast({title: '登录成功'});\r\n            uni.setStorageSync('user_id', new Date().toString());\r\n            uni.setStorageSync('user_nickName', this.userInfo.nickName);\r\n            uni.setStorageSync('user_avatarUrl', this.userInfo.avatarUrl);\r\n            uni.setStorageSync('user_nu', new Date().toString());\r\n            uni.switchTab({url: '/pages/Home/Home'});\r\n            // 隐藏loading\r\n            uni.hideLoading();\r\n\r\n            // 3.通过 openId 判断用户是否授权\r\n            // uni.request({\r\n            //   url: _self.apiServer + 'loginApplets',\r\n            //   data: {\r\n            //     openid: _self.openId\r\n            //   },\r\n            //   method: 'POST',\r\n            //   success: openIdRes => {\r\n            //     console.log(openIdRes);\r\n            //     // 隐藏loading\r\n            //     uni.hideLoading();\r\n            //     // 还没授权登录、请先授权然后登录\r\n            //     if (openIdRes.data.code == 1) {\r\n            //       // 提示消息、让用户授权\r\n            //       uni.showToast({\r\n            //         title: openIdRes.data.msg,\r\n            //         icon: 'none'\r\n            //       });\r\n            //     }\r\n            //     // 已经授权了、查询到用户的数据了\r\n            //     if (openIdRes.data.code == 0) {\r\n            //       // 用户信息写入缓存\r\n            //       uni.showToast({ title: '登录成功' });\r\n            //       uni.setStorageSync('user_id', openIdRes.data.res.u_id);\r\n            //       uni.setStorageSync('user_nm', openIdRes.data.res.u_nickName);\r\n            //       uni.setStorageSync('user_fa', openIdRes.data.res.u_avatarUrl);\r\n            //       uni.setStorageSync('user_nu', openIdRes.data.res.u_regtime);\r\n            //       // 然后跳回原页面\r\n            //       if (_self.pageOption.backtype == 1) {\r\n            //         uni.redirectTo({ url: _self.pageOption.backpage });\r\n            //       } else {\r\n            //         uni.switchTab({ url: _self.pageOption.backpage });\r\n            //       }\r\n            //     }\r\n            //   },\r\n            //   fail: () => {\r\n            //     uni.showToast({\r\n            //       title: '获取授权信息失败',\r\n            //       icon: 'none'\r\n            //     });\r\n            //     return false;\r\n            //   }\r\n            // });\r\n          },\r\n          fail: () => {\r\n            uni.showToast({\r\n              title: '获取 SesssionKey OpenId 失败',\r\n              icon: 'none'\r\n            });\r\n            return false;\r\n          }\r\n        });\r\n      },\r\n      fail: () => {\r\n        uni.showToast({\r\n          title: '获取 code 失败',\r\n          icon: 'none'\r\n        });\r\n        return false;\r\n      }\r\n    });\r\n    return false;\r\n  }\r\n\r\n  onGetPhoneNumber(e) {\r\n    debugger\r\n    if (e.detail.errMsg == \"getPhoneNumber:fail user deny\") {       //用户决绝授权\r\n      debugger\r\n      //拒绝授权后弹出一些提示\r\n\r\n    } else {      //允许授权\r\n      debugger\r\n      console.log(e.detail.encryptedData)\r\n      e.detail.encryptedData      //加密的用户信息\r\n      e.detail.iv     //加密算法的初始向量  时要用到\r\n    }\r\n  }\r\n\r\n  onLoad(options) {\r\n    debugger\r\n    // 接收跳转的参数\r\n    this.pageOption = options;\r\n    //默认加载\r\n    // this.login();\r\n  }\r\n}\r\n"],"sourceRoot":""}