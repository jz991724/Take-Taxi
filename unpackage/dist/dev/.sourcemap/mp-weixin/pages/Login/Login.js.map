{"version":3,"sources":["uni-app:///main.js","webpack:///D:/BaiduNetdiskDownload/TakeTaxi/pages/Login/Login.vue?5282","webpack:///D:/BaiduNetdiskDownload/TakeTaxi/pages/Login/Login.vue?1e2c","webpack:///D:/BaiduNetdiskDownload/TakeTaxi/pages/Login/Login.vue?0eaa","webpack:///D:/BaiduNetdiskDownload/TakeTaxi/pages/Login/Login.vue?6512","uni-app:///pages/Login/Login.vue?vue&type=script&lang=ts&"],"names":["createPage","Page"],"mappings":"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","file":"pages/Login/Login.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/Login/Login.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./Login.vue?vue&type=template&id=3a2da0cc&\"\nvar renderjs\nimport script from \"./Login.vue?vue&type=script&lang=ts&\"\nexport * from \"./Login.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/Login/Login.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Login.vue?vue&type=template&id=3a2da0cc&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Login.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Login.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Mixins } from 'vue-property-decorator';\nimport VueMixins from '../../mixins/VueMixins.ts';\n\n@Component({\n  name: 'Login'\n})\nexport default class Login extends Mixins(VueMixins) {\n  appid = '*************';\n  secret = '*************************';\n  code = '';\n  sessionKey = '';\n  openId = '';\n  userInfo = {\n    avatarUrl: '',\n    city: '',\n    country: '',\n    gender: 0,\n    language: '',\n    nickName: '',\n    province: '',\n  };\n  pageOption = {};\n\n  // 第一授权获取用户信息 ===》按钮触发\n  wxGetUserInfo() {\n    // 1.获取用户的信息\n    uni.getUserInfo({\n      provider: 'weixin',\n      success: (infoRes) => {\n        debugger\n        console.log(infoRes);\n        this.userInfo = infoRes.userInfo;\n\n        // 用户信息写入缓存\n        uni.showToast({ title: '登录成功' });\n        uni.setStorageSync('user_id', new Date().toString());\n        uni.setStorageSync('user_nm', this.userInfo.nickName);\n        uni.setStorageSync('user_fa', this.userInfo.avatarUrl);\n        uni.setStorageSync('user_nu', new Date().toString());\n\n        uni.switchTab({ url: '/pages/Home/Home' })\n\n        // 2.提交数据到后台、写入数据库\n        // uni.request({\n        //   url: _self.apiServer + 'appletsUserInfo',\n        //   data: {\n        //     openid: _self.openId,\n        //     avatarUrl: _self.userInfo.avatarUrl,\n        //     city: _self.userInfo.city,\n        //     country: _self.userInfo.country,\n        //     gender: _self.userInfo.gender,\n        //     language: _self.userInfo.language,\n        //     nickName: _self.userInfo.nickName\n        //   },\n        //   method: 'POST',\n        //   success: res => {\n        //     if (res.data.code != 0) {\n        //       uni.showToast({\n        //         title: res.data.msg,\n        //         icon: 'none'\n        //       });\n        //       return false;\n        //     }\n        //     // 用户信息写入缓存\n        //     uni.showToast({ title: '登录成功' });\n        //     uni.setStorageSync('user_id', res.data.res.u_id);\n        //     uni.setStorageSync('user_nm', res.data.res.u_nickName);\n        //     uni.setStorageSync('user_fa', res.data.res.u_avatarUrl);\n        //     uni.setStorageSync('user_nu', res.data.res.u_regtime);\n        //     // 然后跳回原页面\n        //     if (_self.pageOption.backtype == 1) {\n        //       uni.redirectTo({ url: _self.pageOption.backpage });\n        //     } else {\n        //       uni.switchTab({ url: _self.pageOption.backpage });\n        //     }\n        //   },\n        //   fail: () => {\n        //     uni.showToast({\n        //       title: '用户信息操作失败',\n        //       icon: 'none'\n        //     });\n        //   }\n        // });\n      },\n      fail: () => {\n        uni.showToast({\n          title: '获取用户信息失败',\n          icon: 'none'\n        });\n      }\n    });\n    return false;\n  }\n\n  // 登录\n  login() {\n    // 0. 显示加载的效果\n    uni.showLoading({\n      title: '登录中...'\n    });\n\n    // 1. wx 获取登录用户 code\n    uni.login({\n      provider: 'weixin',\n      success: loginRes => {\n        console.log(loginRes);\n        this.code = loginRes.code;\n        // 2. 将用户登录code传递到后台置换用户SessionKey、OpenId等信息\n        uni.request({\n          url:\n              'https://api.weixin.qq.com/sns/jscode2session?appid=' +\n              this.appid +\n              '&secret=' +\n              this.secret +\n              '&js_code=' +\n              this.code +\n              '&grant_type=authorization_code',\n          success: codeRes => {\n            console.log(codeRes);\n            this.openId = codeRes.data.openid;\n            this.sessionKey = codeRes.data.session_key;\n\n            // 用户信息写入缓存\n            uni.showToast({ title: '登录成功' });\n            uni.setStorageSync('user_id', new Date().toString());\n            uni.setStorageSync('user_nm', this.userInfo.nickName);\n            uni.setStorageSync('user_fa', this.userInfo.avatarUrl);\n            uni.setStorageSync('user_nu', new Date().toString());\n            uni.switchTab({ url: '/pages/Home/Home' });\n            // 隐藏loading\n            uni.hideLoading();\n\n            // 3.通过 openId 判断用户是否授权\n            // uni.request({\n            //   url: _self.apiServer + 'loginApplets',\n            //   data: {\n            //     openid: _self.openId\n            //   },\n            //   method: 'POST',\n            //   success: openIdRes => {\n            //     console.log(openIdRes);\n            //     // 隐藏loading\n            //     uni.hideLoading();\n            //     // 还没授权登录、请先授权然后登录\n            //     if (openIdRes.data.code == 1) {\n            //       // 提示消息、让用户授权\n            //       uni.showToast({\n            //         title: openIdRes.data.msg,\n            //         icon: 'none'\n            //       });\n            //     }\n            //     // 已经授权了、查询到用户的数据了\n            //     if (openIdRes.data.code == 0) {\n            //       // 用户信息写入缓存\n            //       uni.showToast({ title: '登录成功' });\n            //       uni.setStorageSync('user_id', openIdRes.data.res.u_id);\n            //       uni.setStorageSync('user_nm', openIdRes.data.res.u_nickName);\n            //       uni.setStorageSync('user_fa', openIdRes.data.res.u_avatarUrl);\n            //       uni.setStorageSync('user_nu', openIdRes.data.res.u_regtime);\n            //       // 然后跳回原页面\n            //       if (_self.pageOption.backtype == 1) {\n            //         uni.redirectTo({ url: _self.pageOption.backpage });\n            //       } else {\n            //         uni.switchTab({ url: _self.pageOption.backpage });\n            //       }\n            //     }\n            //   },\n            //   fail: () => {\n            //     uni.showToast({\n            //       title: '获取授权信息失败',\n            //       icon: 'none'\n            //     });\n            //     return false;\n            //   }\n            // });\n          },\n          fail: () => {\n            uni.showToast({\n              title: '获取 SesssionKey OpenId 失败',\n              icon: 'none'\n            });\n            return false;\n          }\n        });\n      },\n      fail: () => {\n        uni.showToast({\n          title: '获取 code 失败',\n          icon: 'none'\n        });\n        return false;\n      }\n    });\n    return false;\n  }\n\n  onLoad(options) {\n    // 接收跳转的参数\n    this.pageOption = options;\n    //默认加载\n    this.login();\n  }\n}\n"],"sourceRoot":""}